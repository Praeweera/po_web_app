<!DOCTYPE html>
<html lang="th">


<head>
    <meta charset="UTF-8">
    <title>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
    <h3 class="mb-4">üìÅ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</h3>
    <a href="/" class="btn btn-secondary mb-3">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</a>

    <h4 class="mb-3">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå)</h4>
    <form method="POST" action="/add_manual_entry" class="row g-2 mb-4">
        <div class="col-md-2">
            <input list="item-options" name="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå" class="form-control form-control-sm" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå" required>
            <datalist id="item-options">
                {% for item in item_options %}
                <option value="{{ item }}">
                {% endfor %}
            </datalist>
        </div>
        <div class="col-md-1">
            <input type="number" name="‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠" class="form-control form-control-sm" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" required>
        </div>
        <div class="col-md-1">
            <input type="text" name="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö" class="form-control form-control-sm" placeholder="‡∏´‡∏ô‡πà‡∏ß‡∏¢" required>
        </div>
        <div class="col-md-2">
            <input list="company-options" name="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="form-control form-control-sm" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" required>
            <datalist id="company-options">
                {% for company in company_options %}
                <option value="{{ company }}">
                {% endfor %}
            </datalist>
        </div>
        <div class="col-md-2">
            <button type="submit" class="btn btn-sm btn-success">‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</button>
        </div>
    </form>



    {% for file in all_data %}
        <h5 class="mt-4">{{ file['filename'] }}</h5>

        <form method="POST" action="/add_entry" class="row g-2 mb-3">
            <input type="hidden" name="filename" value="{{ file['filename'] }}">
            <div class="col-md-2">
                <input list="item-options" name="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå" class="form-control form-control-sm" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå" required>
                <datalist id="item-options">
                    {% for item in item_options %}
                    <option value="{{ item }}">
                    {% endfor %}
                </datalist>
            </div>
            <div class="col-md-1">
                <input type="number" name="‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠" class="form-control form-control-sm" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" required>
            </div>
            <div class="col-md-1">
                <input type="text" name="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö" class="form-control form-control-sm" placeholder="‡∏´‡∏ô‡πà‡∏ß‡∏¢" required>
            </div>
            <div class="col-md-2">
                <input list="company-options" name="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" class="form-control form-control-sm" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" required>
                <datalist id="company-options">
                    {% for company in company_options %}
                    <option value="{{ company }}">
                    {% endfor %}
                </datalist>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-sm btn-success">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</button>
            </div>
        </form>


        <button class="btn btn-outline-dark btn-sm mb-2" onclick="printTable('{{ loop.index0 }}')">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</button>
        <table class="table table-bordered table-sm">
        <table id="table-{{ loop.index0 }}" class="table table-bordered table-sm">
            <thead class="table-light">
                <tr>
                    <th>PO Number</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå</th>
                    <th>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠</th>
                    <th>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</th>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</th>
                    <th>‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á</th>
                    <th>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</th>
                </tr>
            </thead>
            <tbody>
                {% for row in file['records'] %}
                {% set row_id = loop.index0 %}
                <tr>
                    <td>{{ row['PO Number'] }}</td>
                    <td>{{ row['‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏ä‡∏†‡∏±‡∏ì‡∏ë‡πå'] }}</td>
                    <td>{{ row['‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠'] }}</td>
                    <td>{{ row['‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏ô‡∏±‡∏ö'] }}</td>
                    <td>{{ row['‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó'] }}</td>
                    <td class="{% if row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á'] == '‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß' %}table-success{% elif row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á'] == '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' %}table-warning{% elif row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á'] == '‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á' %}table-danger{% endif %}">
                        <form method="POST" action="/update_history_status">
                            <input type="hidden" name="filename" value="{{ file['filename'] }}">
                            <input type="hidden" name="row_id" value="{{ row_id }}">
                            <select name="new_status" class="form-select form-select-sm status-select">
                                <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á" {% if row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á'] == '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á' %}selected{% endif %}>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á</option>
                                <option value="‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß" {% if row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á'] == '‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß' %}selected{% endif %}>‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß</option>
                                <option value="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å" {% if row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á'] == '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å' %}selected{% endif %}>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</option>
                                <option value="‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á" {% if row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á'] == '‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á' %}selected{% endif %}>‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á</option>
                            </select>
                    </td>

                    <td>
                        <input type="number" name="pending_qty" class="form-control form-control-sm" style="width: 80px;" min="0" value="{{ row['‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á'] }}">
                    </td>

                    <td>
                        <button type="submit" class="btn btn-sm btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                        </form>
                    </td>
                    
                    <td>
                        <form method="POST" action="/delete_history_row" onsubmit="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?');">
                            <input type="hidden" name="filename" value="{{ file['filename'] }}">
                            <input type="hidden" name="po_number" value="{{ row['PO Number'] }}">
                            <button type="submit" class="btn btn-sm btn-danger">‡∏•‡∏ö</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>

        </table>
    {% endfor %}

<script>
function updateSelectColor(select) {
    select.classList.remove('bg-success', 'bg-warning', 'bg-danger', 'bg-secondary', 'text-white');

    const value = select.value;
    if (value === '‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß') {
        select.classList.add('bg-success', 'text-white');
    } else if (value === '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å') {
        select.classList.add('bg-warning');
    } else if (value === '‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡πà‡∏á') {
        select.classList.add('bg-danger', 'text-white');
    } else {
        select.classList.add('bg-secondary', 'text-white');
    }
}

document.querySelectorAll('.status-select').forEach(select => {
    updateSelectColor(select); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î
    select.addEventListener('change', () => updateSelectColor(select)); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤
});
</script>


<script>
function printTable(tableId) {
    const table = document.getElementById('table-' + tableId);
    const newWin = window.open('', '', 'width=900,height=600');
    newWin.document.write('<html><head><title>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</title>');
    newWin.document.write('<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">');
    newWin.document.write('</head><body class="p-3">');
    newWin.document.write('<h4>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå</h4>');
    newWin.document.write(table.outerHTML);
    newWin.document.write('</body></html>');
    newWin.document.close();
    newWin.print();
}
</script>



</body>
</html>



</body>
</html>
